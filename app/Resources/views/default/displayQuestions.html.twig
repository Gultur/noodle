{% extends 'layout.html.twig' %}

{% set page_title = 'Affichage des questions' %}
{% block content %}

    <main class="container">
        {% if (is_granted("ROLE_TEACHER") == true or is_granted("ROLE_ADMIN") == true ) %}

        <h1>Liste des questions</h1>



        <div >
            <div class="panel-group" id="accordion">
                {% for question in questions %}
                    {% set collapse_id = 'collapse'~ question.id %}

                    <div class="panel panel-default question text-center">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#{{ collapse_id }}"><span class="glyphicon glyphicon-plus"></span> <em>Intitulé de la question : </em>{{ question.name }}</a>
                            </h4>
                        </div>
                        <div id="{{ collapse_id }}" class="panel-collapse collapse">
                            <div class="panel-body">
                                <p><em>Enoncé : </em>{{ question.question }}</p>
                                <p><em>Type de la question :</em>
                                    {% if question.type == 'text' %}
                                        texte
                                    {% elseif question.type == 'trueOrFalse' %}
                                        vrai ou faux
                                    {% elseif question.type == 'multipleChoicesRadio' %}
                                        choix multiple, une seule réponse correcte
                                    {% elseif question.type == 'multipleChoicesCheckBox' %}
                                        choix multiple, au moins une bonne réponse
                                    {% endif %}
                                </p>
                                <p><em>Durée : </em>{{ question.time }} seconde(s)</p>

                                <div class="answer">
                                    <p><em>Réponse(s) (une bonne réponse est en vert): </em></p>

                                    {% for answer in question.answers %}

                                        {% if answer.correct == 1 %}
                                            <p class="text-success"> {{ answer.value }} </p>
                                        {% elseif answer.correct == 0 %}
                                            <p class="text-danger">{{  answer.value }}</p>
                                        {% endif %}

                                    {% endfor %}
                                </div>

                                {% if is_granted("ROLE_ADMIN") %}
                                    <a class="btn btn-primary" href="{{ path("deletequestion", {"id": question.id}) }}" onclick="return confirm('Confirmer la suppression?')">Supprimer</a>
                                {% endif %}
                                <hr>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>



            </div>

        {% endif %}


        <script>
            $(document).ready(function(){
                // Add minus icon for collapse element which is open by default
                $(".collapse.in").each(function(){
                    $(this).siblings(".panel-heading").find(".glyphicon").addClass("glyphicon-minus").removeClass("glyphicon-plus");
                });

                // Toggle plus minus icon on show hide of collapse element
                $(".collapse").on('show.bs.collapse', function(){
                    $(this).parent().find(".glyphicon").removeClass("glyphicon-plus").addClass("glyphicon-minus");
                }).on('hide.bs.collapse', function(){
                    $(this).parent().find(".glyphicon").removeClass("glyphicon-minus").addClass("glyphicon-plus");
                });
            });
        </script>
    </main>

{% endblock %}

